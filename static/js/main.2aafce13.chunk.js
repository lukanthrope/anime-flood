(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{118:function(e,t){},121:function(e,t,a){},122:function(e,t,a){},123:function(e,t,a){},124:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(25),s=a.n(c),o=a(8),u=a(34),l={showSpinner:!1,user:"null"===localStorage.getItem("user")?null:localStorage.getItem("user")};var i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_SPINNER":return Object(u.a)({},e,{showSpinner:!e.showSpinner});case"AUTHORIZE":return Object(u.a)({},e,{user:t.payload.username});default:return e}},m=a(26),p=Object(m.b)(i),d=a(6),f=a.n(d),h=a(9),b=a(5),E=a(11),v=a.n(E),g=a(60),w=a.n(g),y=a(61),O=a.n(y),k=a(128),j=a(129),x=Object(o.b)(null,function(e){return{showSpinner:function(){return e({type:"SHOW_SPINNER"})},authorize:function(t){return e({type:"AUTHORIZE",payload:{username:t}})}}})(function(e){var t=e.authorize,a=e.showSpinner,c=Object(n.useState)(""),s=Object(b.a)(c,2),o=s[0],u=s[1],l=Object(n.useState)(""),i=Object(b.a)(l,2),m=i[0],p=i[1],d=Object(n.useState)(""),E=Object(b.a)(d,2),g=E[0],w=E[1],y=function(){var e=Object(h.a)(f.a.mark(function e(n){var r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),a(),e.prev=2,e.next=5,v.a.post("https://shrouded-depths-50130.herokuapp.com/api/registration",{username:o,password:m});case 5:if(r=e.sent,x(r.data),!r.data.registred){e.next=13;break}return localStorage.setItem("user",o),localStorage.setItem("token",r.data.token),t(o),a(),e.abrupt("return");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(2),console.log(e.t0);case 18:a();case 19:case"end":return e.stop()}},e,null,[[2,15]])}));return function(t){return e.apply(this,arguments)}}(),O="fulfill this field",x=function(e){var t={"username: Path `username` is required., password: Path `password` is required.":O,"username: Path `username` is required., password: Short password":O,"username: Path `username` is required.":"enter username","password: Path `password` is required.":"enter password","password: Short password":"short password","username taken":"username taken",default:""};w(t[e]||t.default)},S=function(e){return!(!g.includes(e)&&g!==O)};return r.a.createElement(k.a,{onSubmit:function(e){return y(e)}},r.a.createElement(k.a.Group,{controlId:"formBasicUsername"},r.a.createElement(k.a.Label,null,"Nickname"),r.a.createElement(k.a.Control,{type:"username",placeholder:"Nickname",value:o,onChange:function(e){return u(e.target.value)},isInvalid:S("username")}),r.a.createElement(k.a.Text,{className:"text-danger"},S("username")?g:"")),r.a.createElement(k.a.Group,{controlId:"formBasicPassword"},r.a.createElement(k.a.Label,null,"Password"),r.a.createElement(k.a.Control,{type:"password",placeholder:"Password",value:m,onChange:function(e){return p(e.target.value)},isInvalid:S("password")}),r.a.createElement(k.a.Text,{className:"text-danger"},S("password")?g:"")),r.a.createElement(k.a.Group,{controlId:"formBasicChecbox"},r.a.createElement(k.a.Check,{type:"checkbox",label:"Check me out"})),r.a.createElement(j.a,{variant:"primary",type:"submit"},"Submit"))}),S=a(125),N=a(126),I=a(64),C=(a(95),Object(o.b)(null,function(e){return{showSpinner:function(){return e({type:"SHOW_SPINNER"})},authorize:function(t){return e({type:"AUTHORIZE",payload:{username:t}})}}})(function(e){var t=e.authorize,a=e.showSpinner,c=Object(n.useState)(""),s=Object(b.a)(c,2),o=s[0],u=s[1],l=Object(n.useState)(""),i=Object(b.a)(l,2),m=i[0],p=i[1],d=Object(n.useState)(null),E=Object(b.a)(d,2),g=E[0],w=E[1],y=function(){var e=Object(h.a)(f.a.mark(function e(n){var r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),a(),""!==o){e.next=5;break}return a(),e.abrupt("return",w("enter your username"));case 5:if(""!==m){e.next=8;break}return a(),e.abrupt("return",w("enter password"));case 8:return e.prev=8,e.next=11,v.a.post("https://shrouded-depths-50130.herokuapp.com/api/login",{username:o,password:m});case 11:if(r=e.sent,console.log(r),"wrong username or password"===r.data){e.next=20;break}return a(),localStorage.setItem("user",o),localStorage.setItem("token",r.data),e.abrupt("return",t(o));case 20:a(),w(r.data);case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(8),console.log(e.t0);case 27:case"end":return e.stop()}},e,null,[[8,24]])}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(k.a,{onSubmit:function(e){return y(e)}},r.a.createElement(k.a.Group,{controlId:"formBasicUsername"},r.a.createElement(k.a.Label,null,"Nickname"),r.a.createElement(k.a.Control,{type:"username",placeholder:"Nickname",value:o,onChange:function(e){return u(e.target.value)},isInvalid:g&&"enter password"!==g}),r.a.createElement(k.a.Text,{className:"text-danger"},"enter your username"===g?g:"")),r.a.createElement(k.a.Group,{controlId:"formBasicPassword"},r.a.createElement(k.a.Label,null,"Password"),r.a.createElement(k.a.Control,{type:"password",placeholder:"Password",value:m,onChange:function(e){return p(e.target.value)},isInvalid:g&&"enter your username"!==g}),r.a.createElement(k.a.Text,{className:"text-danger"},g&&"enter your username"!==g?g:"")),r.a.createElement(k.a.Group,{controlId:"formBasicChecbox"},r.a.createElement(k.a.Check,{type:"checkbox",label:"Check me out"})),r.a.createElement(j.a,{variant:"primary",type:"submit"},"Submit"))})),P=function(){var e=Object(n.useState)(!0),t=Object(b.a)(e,2),a=t[0],c=t[1],s=function(){return c(function(e){return!e})};return Object(n.useEffect)(function(){document.body.style.overflow="hidden",document.body.style.background="white"},[]),r.a.createElement("div",{className:"container"},r.a.createElement(S.a,null,r.a.createElement("h1",{className:"h1-header"},"Wecome to Anime-Flood"),r.a.createElement(N.a,null,r.a.createElement(I.a,{xs:"2",lg:"3"},r.a.createElement("img",{className:"firstPic lendingPic",src:w.a,alt:"tyan"})),r.a.createElement(I.a,{xs:"8",lg:"6"},a?r.a.createElement("h4",null,"Sign in",r.a.createElement("span",{className:"text-muted small"}," have no account?",r.a.createElement("span",{className:"sign",onClick:s}," sign up"))):r.a.createElement("h4",null,"Registration",r.a.createElement("span",{className:"text-muted small"}," have an account?",r.a.createElement("span",{className:"sign",onClick:s}," sign in"))),a?r.a.createElement(C,null):r.a.createElement(x,null)),r.a.createElement(I.a,{xs:"2",lg:"3"},r.a.createElement("img",{className:"lendingPic",src:O.a,alt:"tyan"})))))},A=a(66),T=a(65),B=a.n(T),R=(a(121),Object(n.memo)(function(e){var t=e.authorize,a=e.username;return r.a.createElement("header",null,r.a.createElement(S.a,{fluid:!0},r.a.createElement(N.a,null,r.a.createElement(I.a,{xs:"8",lg:"10"},r.a.createElement("h2",{className:"logo"},"Amime-flood")),r.a.createElement(I.a,{xs:"1",lg:"2"},r.a.createElement("span",{className:"font-weight-bold span-username"},a," "),r.a.createElement(j.a,{variant:"light",onClick:function(){return t(null)}},"logout")))))})),H=Object(o.b)(null,function(e){return{authorize:function(t){localStorage.clear(),e({type:"AUTHORIZE",payload:{username:t}})}}})(R),z=a(127),G=Object(n.memo)(function(e){var t=e.username,a=e.image,n=e.classProp;return r.a.createElement("div",{className:"Message"},r.a.createElement(z.a,{className:"messageImage ".concat(n),thumbnail:!0,src:a,alt:"image"}),r.a.createElement("h3",{className:"name ".concat(n)},t))}),L=function(){return r.a.createElement("div",{className:"background"},r.a.createElement("div",{className:"lds-dual-ring"}))},U=(a(122),B()("https://shrouded-depths-50130.herokuapp.com"));var W=Object(o.b)(function(e){return{username:e.user,spinner:e.spinner}})(function(e){var t=e.username,a=Object(n.useState)(),c=Object(b.a)(a,2),s=c[0],o=c[1],u=Object(n.useState)(),l=Object(b.a)(u,2),i=l[0],m=l[1],p=Object(n.useRef)(null),d=Object(n.useState)(null),E=Object(b.a)(d,2),g=E[0],w=E[1],y=Object(n.useState)({display:"block"}),O=Object(b.a)(y,2),k=O[0],j=O[1],x=function(){var e=Object(h.a)(f.a.mark(function e(a){var n,r,c;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.preventDefault(),n=a.target.files[0],(r=new FormData).append("file",n),a.target.value=null,e.prev=5,e.next=8,v.a.post("https://shrouded-depths-50130.herokuapp.com/upload",r,{headers:{"Content-Type":"multipart/form-data"}});case 8:c=e.sent,U.emit("mes",{url:c.data.fileName,author:t}),w(!1),console.log(c),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),w(e.t0);case 17:case"end":return e.stop()}},e,null,[[5,14]])}));return function(t){return e.apply(this,arguments)}}(),S=function(){return p.current.scrollIntoView({behavior:"smooth"})};return Object(n.useEffect)(function(){document.body.style.overflow="auto",document.body.style.background="lavender";var e=function(){window.pageYOffset>document.body.clientHeight/2?j({display:"none"}):j({display:"block"})};return window.addEventListener("scroll",e),m(!0),Object(h.a)(f.a.mark(function e(){var t;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.get("https://shrouded-depths-50130.herokuapp.com/api/messages");case 3:0===(t=e.sent).data.length&&w(!0),o(t.data),m(!1),setTimeout(function(){return S()},1e3),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),w(e.t0);case 13:case"end":return e.stop()}},e,null,[[0,10]])}))(),function(){return window.removeEventListener("scroll",e)}},[]),Object(n.useEffect)(function(){Array.isArray(s)&&U.on("new message",function(e){o([].concat(Object(A.a)(s),[e])),j({display:"block"}),w(!1)})},[s]),r.a.createElement("div",{className:"Chat"},r.a.createElement(H,{username:t}),i&&r.a.createElement(L,null),r.a.createElement("div",{className:"container chat-container"},s&&!i&&s.map(function(e,a,n){var c=e.url,s=e.author;return r.a.createElement(G,{image:c,username:s,classProp:t===s?"mine":"",key:a,ref:a===n.length-1?p:null})}),g&&r.a.createElement("h3",{className:"empty"},"No messages yet, bratishka")),r.a.createElement("div",{ref:p}),r.a.createElement("div",{className:"fileContainer"},"send",r.a.createElement("input",{onChange:function(e){return x(e)},type:"file",name:"myFile",className:"inputfile"})),r.a.createElement("button",{style:k,onClick:S,className:"godown"},"\u2193"))});a(123);var q=Object(o.b)(function(e){return{spinner:e.showSpinner,username:e.user}})(function(e){var t=e.spinner,a=Object(n.useState)(void 0),c=Object(b.a)(a,2),s=c[0],o=c[1],u=function(){var e=Object(h.a)(f.a.mark(function e(){var t;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("token"),e.prev=1,e.next=4,v.a.get("https://shrouded-depths-50130.herokuapp.com/api/chat",{headers:{Authorization:"Bearer ".concat(t)}});case 4:o(!0),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),o(!1);case 10:case"end":return e.stop()}},e,null,[[1,7]])}));return function(){return e.apply(this,arguments)}}();return Object(n.useEffect)(function(){Object(h.a)(f.a.mark(function e(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}))()}),r.a.createElement("div",{className:"App"},t&&r.a.createElement(L,null),"undefined"===typeof s?r.a.createElement(L,null):s?r.a.createElement(W,null):r.a.createElement(P,null))});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(o.a,{store:p},r.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},60:function(e,t,a){e.exports=a.p+"static/media/tyan3.fe773703.png"},61:function(e,t,a){e.exports=a.p+"static/media/tyan2.00fc3172.png"},67:function(e,t,a){e.exports=a(124)},95:function(e,t,a){}},[[67,1,2]]]);
//# sourceMappingURL=main.2aafce13.chunk.js.map